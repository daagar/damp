<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MudletPackage>
<MudletPackage version="1.0">
    <TriggerPackage>
        <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>dmap</name>
            <script></script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList/>
            <regexCodePropertyList/>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>Check for 'other' exits</name>
                <script>
setRoomChar(gmcp.room.info.num, &quot;&gt;&quot;)</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^\[ Exits: .*other.* \]$</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="no" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>specialExitsTracker</name>
                <script>toRoom = damp.map.current_room

damp.log:debug(&quot;fromRoom: &quot;..fromRoom)
damp.log:debug(&quot;toRoom: &quot;..toRoom)
disableTrigger(&quot;specialExitsTracker&quot;)
addSpecialExit(fromRoom, toRoom, specialExitCommand) </script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^\[ Exits:.* \]$</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
        </TriggerGroup>
        <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>chat</name>
            <script></script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList/>
            <regexCodePropertyList/>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>newbie</name>
                <script>enableTrigger(&quot;blankline&quot;)
selectString(matches[2],1)
replace(&quot;&quot;)
demonnic.chat:append(&quot;Newbie&quot;)
deselect()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>1</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^(\{chan ch=newbie\})(.*)</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>auction</name>
                <script>enableTrigger(&quot;blankline&quot;)
selectString(matches[2],1)
replace(&quot;&quot;)
demonnic.chat:append(&quot;Auc&quot;)
deselect()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^(\{chan ch=auction\})(.*)</string>
                    <string>^(\{chan ch=barter\})(.*)</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="no" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>all</name>
                <script>--showCaptureGroups()
selectString(matches[2],1)
replace(&quot;&quot;)
--copy()
chat:Append(&quot;Test&quot;)
--deleteLine()
deselect()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^(\{chan ch=.*\})(.*)</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>question</name>
                <script>enableTrigger(&quot;blankline&quot;)
selectString(matches[2],1)
replace(&quot;&quot;)
demonnic.chat:append(&quot;?&quot;)
deselect()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^(\{chan ch=question\})(.*)</string>
                    <string>^(\{chan ch=answer\})(.*)</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="no" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>blankline</name>
                <script>disableTrigger(&quot;blankline&quot;)
deleteLine()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^$</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>tech</name>
                <script>enableTrigger(&quot;blankline&quot;)
selectString(matches[2],1)
replace(&quot;&quot;)
demonnic.chat:append(&quot;Tech&quot;)
deselect()</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^(\{chan ch=tech\})(.*)</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
        </TriggerGroup>
        <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>status</name>
            <script></script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList/>
            <regexCodePropertyList/>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>noexp_on</name>
                <script>raiseEvent(&quot;noexp&quot;, 1)</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^You will no longer receive experience. Happy questing!$</string>
                    <string>^You have set your character to receive no experience points!$</string>
                    <string>&gt;\*\[NOEXP\]\*</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                    <integer>1</integer>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>noexp_off</name>
                <script>raiseEvent(&quot;noexp&quot;, 0)</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^You will now receive experience. Happy leveling!$</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
        </TriggerGroup>
        <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>connect complete</name>
            <script>raiseEvent(&quot;inGame&quot;)
</script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList>
                <string>^Welcome to Aardwolf. May your adventures be mystical, challenging and rewarding.$</string>
                <string>^############# Reconnecting to Game #############$</string>
            </regexCodeList>
            <regexCodePropertyList>
                <integer>1</integer>
                <integer>1</integer>
            </regexCodePropertyList>
        </Trigger>
    </TriggerPackage>
    <TimerPackage/>
    <AliasPackage>
        <Alias isActive="yes" isFolder="no">
            <name>initialize damp</name>
            <script>dampOnStart()</script>
            <command></command>
            <packageName></packageName>
            <regex>^damp$</regex>
        </Alias>
        <AliasGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <script></script>
            <command></command>
            <packageName></packageName>
            <regex></regex>
            <Alias isActive="yes" isFolder="no">
                <name>Reinit Map</name>
                <script>-- Reinitalize the map
damp.init_map()</script>
                <command></command>
                <packageName></packageName>
                <regex>^dmap$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>Reset Zone</name>
                <script>damp.map:resetZone(matches[2])
damp.map.current_room = nil
damp.map.prior_room = nil
</script>
                <command></command>
                <packageName></packageName>
                <regex>^dmreset (.*)$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>dmzones</name>
                <script>-- Show all visted zones (as far as the mapper knows)
display(getAreaTable())</script>
                <command></command>
                <packageName></packageName>
                <regex>^dmzones$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>add door</name>
                <script>-- Add a door visually to the map in the direction indicated, with the status
-- Ex., &quot;]w closed&quot; for a closed door to the west

local status
if (matches[3] == &quot;open&quot;) then status = 1
elseif (matches[3] == &quot;closed&quot;) then status = 2
elseif (matches[3] == &quot;locked&quot;) then status = 3
else status = matches[3]
end
setDoor(damp.map.current_room, matches[2], status)</script>
                <command></command>
                <packageName></packageName>
                <regex>^](.?) (\w+)$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>remove door</name>
                <script>setDoor(damp.map.current_room, matches[2], 0)</script>
                <command></command>
                <packageName></packageName>
                <regex>^\[(.?)$</regex>
            </Alias>
            <Alias isActive="no" isFolder="no">
                <name>link rooms</name>
                <script>-- Given a direction, link the current room to the room is noted direction
connectExitStub(damp.map.current_room, matches[2])
centerview()</script>
                <command></command>
                <packageName></packageName>
                <regex>^\.\.(\w)$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>Create Special Exit</name>
                <script>-- Create a special exit with the command given. For example,
-- &gt;climb rope

-- Be sure to use 'long' directions when using this alias for doors!
-- Ex., &gt;open north, north


specialExitCommand = string.gsub(matches[2], &quot;,&quot;, &quot;;&quot;)

fromRoom = damp.map.current_room
enableTrigger(&quot;specialExitsTracker&quot;)
send(specialExitCommand)


 </script>
                <command></command>
                <packageName></packageName>
                <regex>^&gt;(.*)$</regex>
            </Alias>
        </AliasGroup>
        <AliasGroup isActive="yes" isFolder="yes">
            <name>dgui</name>
            <script></script>
            <command></command>
            <packageName></packageName>
            <regex></regex>
            <Alias isActive="yes" isFolder="no">
                <name>GUI init</name>
                <script>
if not system_init then
  init()
end

init_gui()
</script>
                <command></command>
                <packageName></packageName>
                <regex>^dgui$</regex>
            </Alias>
        </AliasGroup>
    </AliasPackage>
    <ActionPackage/>
    <ScriptPackage>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>damp</name>
            <packageName></packageName>
            <script>damp = damp or {}
damp.gui = damp.gui or {}
damp.map = damp.map or {}
damp.log = damp.log or {}
</script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>config</name>
                <packageName></packageName>
                <script>
-----------------------
-- User Config
-----------------------

-- Set this path to where you cloned/downloaded the scripts
damp.script_path = &quot;d:/dev/github/damp&quot;

-- Set to true to enable the GUI functionality
damp.gui.enable = true

-- Set to true to enable the mapping script
damp.map.enable = true

-- Turn on debug output. Tends to be pretty spammy.
damp.log.enableDebug = false</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>dampOnStart</name>
                <packageName></packageName>
                <script>function dampOnStart()
	-- Initialize logging. Note that debug mode is overly spammy when mapping!
   dofile(damp.script_path..&quot;/dlog/logger.lua&quot;)

  	damp.command = nil

  	sendGMCP(&quot;request quest&quot;)
	sendGMCP(&quot;request char&quot;)
	enableTimer(&quot;gmcp_request_quest&quot;)

  	if (damp.gui.enable) then damp:init_gui() end
  	if (damp.map.enable) then damp:init_map() end

	damp.init = true
  	damp.log:info(&quot;Scripts initialized&quot;)

	if not(demonnic.chat) then
		damp.log:info(&quot;This package is designed to optionally work with Demonnic's Tabbed Chat plugin&quot;)
		damp.log:info(&quot;Please visit http://code.google.com/p/mudlet-packages/downloads/list&quot;)
		damp.log:info(&quot;and download YATCO-2.3.xml (or newer)&quot;)
		disableTrigger(&quot;chat&quot;)
	end

end</script>
                <eventHandlerList>
                    <string>sysLoadEvent</string>
                </eventHandlerList>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onSysDataSendRequest</name>
                <packageName></packageName>
                <script>function onSysDataSendRequest(event, args)
  damp.command = args

if (table.contains(damp.CARDINAL_EXITS_SHORT, damp.command)) then
for k,v in pairs(getSpecialExitsSwap(damp.map.current_room)) do 
  for key, value in pairs(getRoomExits(damp.map.current_room)) do
		if v == value and key == damp.CARDINAL_EXITS_EXPAND[damp.command] then 
			damp.log:debug(&quot;Found special exit to follow&quot;)
			--damp.special_move = true
			gotoRoom(v) 
		   denyCurrentSend()
			--damp.command = &quot;&quot;
			return
		end
	end
end
--damp.log:debug(damp.command)
--send(&quot;west&quot;, false)
end

end


</script>
                <eventHandlerList>
                    <string>sysDataSendRequest</string>
                </eventHandlerList>
            </Script>
        </ScriptGroup>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <packageName></packageName>
            <script>mudlet = mudlet or {}
mudlet.mapper_script = true
</script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>init_map</name>
                <packageName></packageName>
                <script>function damp:init_map()
  
  sendGMCP(&quot;rawcolor on&quot;)
  
  dofile(damp.script_path..&quot;/dmap/gmcp_room.lua&quot;)
  dofile(damp.script_path..&quot;/dmap/exits.lua&quot;)
  dofile(damp.script_path..&quot;/dmap/rooms.lua&quot;)
  dofile(damp.script_path..&quot;/dmap/zones.lua&quot;)
  dofile(damp.script_path..&quot;/dmap/continents.lua&quot;)
  dofile(damp.script_path..&quot;/dmap/speedwalk.lua&quot;)
  
  damp.map.current_zone = nil
  damp.map.current_room = nil
  damp.map.prior_room = nil
  damp.map.prior_room_data = {}
  damp.map.seen_room = nil
  damp.map.terrain = {}
  damp.map.sectors = nil
  
  damp.map.init = true
  damp.log:info(&quot;Initalized damp mapper&quot;)
  
end</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onRoom</name>
                <packageName></packageName>
                <script>function onRoom()
  if not (damp.map.init) then return end

  if (damp.special_move) then 
	damp.special_move = false
	return 
  end
  damp.log:debug(&quot;Parsing room&quot;)
  damp.map:parseGmcpRoom()
end</script>
                <eventHandlerList>
                    <string>gmcp.room</string>
                </eventHandlerList>
            </Script>
        </ScriptGroup>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>dgui</name>
            <packageName></packageName>
            <script></script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>map</name>
                <packageName></packageName>
                <script>
function damp.gui:drawMap()

	damp.gui.main = Geyser.Container:new({x=0,y=0,width=&quot;100%&quot;,height=&quot;100%&quot;,name=&quot;mapper container&quot;})

	damp.gui.mapper = Geyser.Mapper:new({
  		name = &quot;mapper&quot;,
  		x = &quot;70%&quot;, y = &quot;50%&quot;, -- edit here if you want to move it
  		width = &quot;30%&quot;, height = &quot;50%&quot;
	}, main)

end</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>bars</name>
                <packageName></packageName>
                <script>function damp.gui:drawCharBars()

damp.gui.bar_container = Geyser.Container:new({
	name = &quot;bar_container&quot;,
	x=0, y=-80,
	width=&quot;25%&quot;, height=80,
})

damp.gui.bar_container2 = Geyser.Container:new({
	name = &quot;bar_container&quot;,
	x=&quot;26%&quot;, y=-80,
	width=&quot;25%&quot;, height=80,
})

damp.gui.hp_bar = Geyser.Gauge:new({
	name = &quot;hp_bar&quot;,
	x=&quot;1%&quot;, y=5,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container)

damp.gui.hp_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #f04141, stop: 1 #cc0000);
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.hp_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666, stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

damp.gui.mana_bar = Geyser.Gauge:new({
	name = &quot;mana_bar&quot;,
	x=&quot;1%&quot;, y=25,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container)

damp.gui.mana_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #1ca1d0 , stop: 1 #04739c );
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.mana_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666, stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

damp.gui.moves_bar = Geyser.Gauge:new({
	name = &quot;moves_bar&quot;,
	x=&quot;1%&quot;, y=45,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container)

damp.gui.moves_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #22b026, stop: 1 #0a890d);
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.moves_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666,  stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

damp.gui.enemy_bar = Geyser.Gauge:new({
	name = &quot;enemy_bar&quot;,
	x=&quot;1%&quot;, y=5,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container2)

damp.gui.enemy_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #f04141, stop: 1 #cc0000);
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.enemy_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666, stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

damp.gui.tnl_bar = Geyser.Gauge:new({
	name = &quot;tnl_bar&quot;,
	x=&quot;1%&quot;, y=25,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container2)

damp.gui.tnl_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #aaa , stop: 1 #666 );
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.tnl_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666, stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

damp.gui.align_bar = Geyser.Gauge:new({
	name = &quot;align_bar&quot;,
	x=&quot;1%&quot;, y=45,
	width=&quot;100%&quot;, height=15,
},damp.gui.bar_container2)

damp.gui.align_bar.front:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #aeb037  , stop: 1 #4e4f19 );
    border-top: 1px black solid;
    border-left: 1px black solid;
    border-bottom: 1px black solid;
    border-radius: 2;
    padding: 1px;]])
damp.gui.align_bar.back:setStyleSheet([[background-color: QLinearGradient( x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #666, stop: 1 #333);
    border-width: 1px;
    border-color: black;
    border-style: solid;
    border-radius: 2;
    padding: 1px;
]])

setBorderBottom(80)

end


</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>status_bars</name>
                <packageName></packageName>
                <script>function damp.gui:drawStatusBar()

damp.gui.status_bar = Geyser.Container:new({
	name = &quot;status_bar&quot;,
	x=0, y=-17,
	width=&quot;65%&quot;, height=15,
})

damp.gui.noexp_label = Geyser.Label:new({
	name = &quot;noexp_label&quot;,
	x=3, y=0,
	width=&quot;75&quot;, height=&quot;100%&quot;,
}, damp.gui.status_bar)

damp.gui.questtimer_label = Geyser.Label:new({
	name = &quot;questtimer_label&quot;,
	x=81, y=0,
	width=&quot;75&quot;, height=&quot;100%&quot;,
}, damp.gui.status_bar)

end</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>init_gui</name>
                <packageName></packageName>
                <script>function damp:init_gui()

	--send(&quot;P&quot;)

	damp.gui:drawMap()
	damp.gui:drawCharBars()
	damp.gui:drawStatusBar()
	
	damp.gui.init = true
	damp.log:info(&quot;Initalized damp GUI&quot;)
end</script>
                <eventHandlerList/>
            </Script>
        </ScriptGroup>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>gmcp events</name>
            <packageName></packageName>
            <script>
</script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>onVitals</name>
                <packageName></packageName>
                <script>function onVitals()

	if not (damp.gui.init) then return end

	-- On startup, char.vitals can come in before maxstats
	if not (gmcp.char.maxstats) then return end

	local hp, maxhp = gmcp.char.vitals.hp, gmcp.char.maxstats.maxhp
	local mp, maxmp = gmcp.char.vitals.mana, gmcp.char.maxstats.maxmana
	local mv, maxmv = gmcp.char.vitals.moves, gmcp.char.maxstats.maxmoves


	local hp_pct = getPercent(hp, maxhp)
	local mp_pct = tostring(getPercent(mp, maxmp))
	local mv_pct = tostring(getPercent(mv, maxmv))

	damp.gui.hp_bar:setValue(hp, maxhp,&quot;&lt;b&gt;&quot;..hp..&quot;hp | &quot;..string.format(&quot;%i&quot;, hp_pct)..&quot;%&lt;/b&gt;&quot;)
	damp.gui.mana_bar:setValue(mp, maxmp,&quot;&lt;b&gt;&quot;..mp..&quot;sp | &quot;..string.format(&quot;%i&quot;, mp_pct)..&quot;%&lt;/b&gt;&quot;)
	damp.gui.moves_bar:setValue(mv, maxmv,&quot;&lt;b&gt;&quot;..mv..&quot;mv | &quot;..string.format(&quot;%i&quot;, mv_pct)..&quot;%&lt;/b&gt;&quot;)

end

function getPercent(top, bottom)
	return (tonumber(top)/tonumber(bottom)) * 100
end</script>
                <eventHandlerList>
                    <string>gmcp.char.vitals</string>
                    <string>gmcp.char.maxstats</string>
                </eventHandlerList>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onQuest</name>
                <packageName></packageName>
                <script>
function onQuest()
	if not (damp.gui.init) then return end

	if (gmcp.comm.quest.wait) then
		damp.gui.questtimer_label:echo(&quot;&lt;center&gt;Q: &quot;..gmcp.comm.quest.wait..&quot;m&lt;/center&gt;&quot;)	
		damp.gui.questtimer_label:setColor(100,100,100)	
	elseif (gmcp.comm.quest.status == &quot;ready&quot;) then
		damp.gui.questtimer_label:echo(&quot;&lt;center&gt;Quest!&lt;/center&gt;&quot;)
		damp.gui.questtimer_label:setColor(0,150,0)
		--disableTimer(&quot;gmcp_request_quest&quot;)
	elseif (gmcp.comm.quest.action == &quot;start&quot; or gmcp.comm.quest.action == &quot;status&quot;) then
		if (gmcp.comm.quest.timer) then
			damp.gui.questtimer_label:echo(&quot;&lt;center&gt;Q: &quot;..gmcp.comm.quest.timer..&quot;m&lt;/center&gt;&quot;)
			damp.gui.questtimer_label:setColor(150,0,0)
		elseif (gmcp.comm.quest.time) then
			damp.gui.questtimer_label:echo(&quot;&lt;center&gt;Q: &quot;..gmcp.comm.quest.time..&quot;m&lt;/center&gt;&quot;)
			damp.gui.questtimer_label:setColor(150, 150, 0)
		end
	end
end
</script>
                <eventHandlerList>
                    <string>gmcp.comm.quest</string>
                </eventHandlerList>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onStatus</name>
                <packageName></packageName>
                <script>function onStatus()
	if not (damp.gui.init) then return end

	local enemy_name, enemy_pct = gmcp.char.status.enemy, gmcp.char.status.enemypct or 0
	local tnl = gmcp.char.status.tnl
	local align = gmcp.char.status.align

	damp.gui.enemy_bar:setValue(enemy_pct, 100, &quot;&lt;b&gt;&quot;..enemy_name..&quot; | &quot;..string.format(&quot;%i&quot;, enemy_pct)..&quot;%&lt;/b&gt;&quot;)
	damp.gui.tnl_bar:setValue(1000-tnl, 1000, &quot;&lt;b&gt;TNL: &quot;..tnl..&quot;&lt;/b&gt;&quot;)
	damp.gui.align_bar:setValue(align+2500, 5000, &quot;&lt;b&gt;Align: &quot;..align..&quot;&lt;/b&gt;&quot;)
end</script>
                <eventHandlerList>
                    <string>gmcp.char.status</string>
                </eventHandlerList>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onSectors</name>
                <packageName></packageName>
                <script>function onSectors()
  if(damp.map.sectors) then return end

  dofile(damp.script_path..&quot;/dmap/sectors.lua&quot;)
  damp.map:setCustomColors()
  damp.map.sectors = true

end
</script>
                <eventHandlerList>
                    <string>gmcp.room.sectors</string>
                </eventHandlerList>
            </Script>
        </ScriptGroup>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>non-gmcp events</name>
            <packageName></packageName>
            <script></script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>onNoexp</name>
                <packageName></packageName>
                <script>
function onNoexp(event, arg)
	if not (damp.gui.init) then return end

	if (arg == 0) then
		damp.gui.noexp_label:echo([[&lt;center&gt;EXP&lt;/center&gt;]])
		damp.gui.noexp_label:setColor(40, 40, 40)
	elseif (arg == 1) then
		damp.gui.noexp_label:echo([[&lt;center&gt;NOEXP&lt;/center&gt;]])
		damp.gui.noexp_label:setColor(225, 0, 0)
	end
end
</script>
                <eventHandlerList>
                    <string>noexp</string>
                </eventHandlerList>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onInGame</name>
                <packageName></packageName>
                <script>-- Actions to occur once we are truly 'in' the game. 
-- Will only fire on first connect/reconnect

function onInGame()
	--local roomSetup = tempTrigger(&quot;[ Exits:&quot;, [[sendGMCP(&quot;request room&quot;) sendGMCP(&quot;request sectors&quot;) damp:roomInit()]])

	-- Need to be fully in-game before getting room/sector info
	sendGMCP(&quot;request room&quot;)
	sendGMCP(&quot;request sectors&quot;)

	-- Force a prompt to display to init various prompt-based flags
	send(&quot;P&quot;,false)
	--send(&quot;look&quot;,false)

	

end
</script>
                <eventHandlerList>
                    <string>inGame</string>
                </eventHandlerList>
            </Script>
        </ScriptGroup>
    </ScriptPackage>
    <KeyPackage>
        <KeyGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <packageName></packageName>
            <script></script>
            <command></command>
            <keyCode>-1</keyCode>
            <keyModifier>-1</keyModifier>
            <Key isActive="yes" isFolder="no">
                <name>North</name>
                <packageName></packageName>
                <script></script>
                <command>n</command>
                <keyCode>56</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>South</name>
                <packageName></packageName>
                <script></script>
                <command>s</command>
                <keyCode>50</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>East</name>
                <packageName></packageName>
                <script></script>
                <command>e</command>
                <keyCode>54</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>West</name>
                <packageName></packageName>
                <script></script>
                <command>w</command>
                <keyCode>52</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Northeast</name>
                <packageName></packageName>
                <script></script>
                <command>ne</command>
                <keyCode>57</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Northwest</name>
                <packageName></packageName>
                <script></script>
                <command>nw</command>
                <keyCode>55</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Southeast</name>
                <packageName></packageName>
                <script></script>
                <command>se</command>
                <keyCode>51</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Southwest</name>
                <packageName></packageName>
                <script></script>
                <command>sw</command>
                <keyCode>49</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Up</name>
                <packageName></packageName>
                <script></script>
                <command>u</command>
                <keyCode>45</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Down</name>
                <packageName></packageName>
                <script></script>
                <command>d</command>
                <keyCode>43</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Look</name>
                <packageName></packageName>
                <script></script>
                <command>l</command>
                <keyCode>53</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
        </KeyGroup>
    </KeyPackage>
    <HelpPackage>
        <helpURL></helpURL>
    </HelpPackage>
</MudletPackage>
