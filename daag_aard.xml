<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MudletPackage>
<MudletPackage version="1.0">
    <TriggerPackage>
        <TriggerGroup isActive="yes" isFolder="yes" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
            <name>dmap</name>
            <script></script>
            <triggerType>0</triggerType>
            <conditonLineDelta>0</conditonLineDelta>
            <mStayOpen>0</mStayOpen>
            <mCommand></mCommand>
            <packageName></packageName>
            <mFgColor>#ff0000</mFgColor>
            <mBgColor>#ffff00</mBgColor>
            <mSoundFile></mSoundFile>
            <colorTriggerFgColor>#000000</colorTriggerFgColor>
            <colorTriggerBgColor>#000000</colorTriggerBgColor>
            <regexCodeList/>
            <regexCodePropertyList/>
            <Trigger isActive="yes" isFolder="no" isTempTrigger="no" isMultiline="no" isPerlSlashGOption="no" isColorizerTrigger="no" isFilterTrigger="no" isSoundTrigger="no" isColorTrigger="no" isColorTriggerFg="no" isColorTriggerBg="no">
                <name>Check for 'other' exits</name>
                <script>
setRoomChar(gmcp.room.info.num, &quot;&gt;&quot;)</script>
                <triggerType>0</triggerType>
                <conditonLineDelta>0</conditonLineDelta>
                <mStayOpen>0</mStayOpen>
                <mCommand></mCommand>
                <packageName></packageName>
                <mFgColor>#ff0000</mFgColor>
                <mBgColor>#ffff00</mBgColor>
                <mSoundFile></mSoundFile>
                <colorTriggerFgColor>#000000</colorTriggerFgColor>
                <colorTriggerBgColor>#000000</colorTriggerBgColor>
                <regexCodeList>
                    <string>^\[ Exits: .*other.* \]$</string>
                </regexCodeList>
                <regexCodePropertyList>
                    <integer>1</integer>
                </regexCodePropertyList>
            </Trigger>
        </TriggerGroup>
    </TriggerPackage>
    <TimerPackage/>
    <AliasPackage>
        <Alias isActive="yes" isFolder="no">
            <name>init</name>
            <script>init()</script>
            <command></command>
            <packageName></packageName>
            <regex>^init$</regex>
        </Alias>
        <AliasGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <script></script>
            <command></command>
            <packageName></packageName>
            <regex></regex>
            <Alias isActive="yes" isFolder="no">
                <name>Map Init</name>
                <script>
if not system_init then
  init()
end

init_map()
send(&quot;look&quot;, false)
daagar.log:info(&quot;Initalized Mapper&quot;)</script>
                <command></command>
                <packageName></packageName>
                <regex>^dminit$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>Reset Zone</name>
                <script>daagar.map:resetZone(matches[2])
daagar.map.current_room = nil
daagar.map.prior_room = nil
</script>
                <command></command>
                <packageName></packageName>
                <regex>^dmreset (.*)$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>dmzones</name>
                <script>display(getAreaTable())</script>
                <command></command>
                <packageName></packageName>
                <regex>^dmzones$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>add door</name>
                <script>local status
if (matches[3] == &quot;open&quot;) then status = 1
elseif (matches[3] == &quot;closed&quot;) then status = 2
elseif (matches[3] == &quot;locked&quot;) then status = 3
else status = matches[3]
end
setDoor(daagar.map.current_room, matches[2], status)</script>
                <command></command>
                <packageName></packageName>
                <regex>^](.?) (\w+)$</regex>
            </Alias>
            <Alias isActive="yes" isFolder="no">
                <name>remove door</name>
                <script>setDoor(daagar.map.current_room, matches[2], 0)</script>
                <command></command>
                <packageName></packageName>
                <regex>^\[(.?)$</regex>
            </Alias>
        </AliasGroup>
    </AliasPackage>
    <ActionPackage/>
    <ScriptPackage>
        <Script isActive="yes" isFolder="no">
            <name>init</name>
            <packageName></packageName>
            <script>function init()

  daagar = daagar or {}
  daagar.log = daagar.log or {}
  script_path = &quot;d:/dev/github/damp&quot;


  --dofile(getMudletHomeDir()..&quot;/scripts/daaglog/logger.lua&quot;)
  dofile(script_path..&quot;/daaglog/logger.lua&quot;)
  daagar.log.enableDebug = true
  daagar.command = nil

  system_init = true
  daagar.log:info(&quot;Scripts initialized&quot;)
end</script>
            <eventHandlerList/>
        </Script>
        <ScriptGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <packageName></packageName>
            <script>mudlet = mudlet or {}
mudlet.mapper_script = true
</script>
            <eventHandlerList/>
            <Script isActive="yes" isFolder="no">
                <name>init_map</name>
                <packageName></packageName>
                <script>function init_map()

  daagar = daagar or {}
  daagar.map = daagar.map or {}
  

  sendGMCP(&quot;rawcolor on&quot;)
  sendGMCP(&quot;request sectors&quot;)
  
  dofile(script_path..&quot;/daagmap/gmcp_room.lua&quot;)
  dofile(script_path..&quot;/daagmap/exits.lua&quot;)
  dofile(script_path..&quot;/daagmap/rooms.lua&quot;)
  dofile(script_path..&quot;/daagmap/zones.lua&quot;)
  dofile(script_path..&quot;/daagmap/continents.lua&quot;)
  tempTimer(2,[[dofile(script_path..&quot;/daagmap/sectors.lua&quot;)]])

  daagar.map.current_zone = nil
  daagar.map.current_room = nil
  daagar.map.prior_room = nil
  daagar.map.prior_room_data = {}
  daagar.map.seen_room = nil
  --daagar.map.fake_room_id = 9999
  daagar.map.terrain = {}
   
  tempTimer(2,[[daagar.map:setCustomColors()]])

  --daagar.map:createFakeZone()

  --setCustomEnvColor(999, unpack(color_table.blue))
  

end</script>
                <eventHandlerList/>
            </Script>
            <Script isActive="yes" isFolder="no">
                <name>onRoom</name>
                <packageName></packageName>
                <script>function onRoom()
  daagar.map:parseGmcpRoom()
  --daagar.map.prior_room_data = gmcp.room
end</script>
                <eventHandlerList>
                    <string>gmcp.room</string>
                </eventHandlerList>
            </Script>
        </ScriptGroup>
        <Script isActive="yes" isFolder="no">
            <name>onSysDataSendRequest</name>
            <packageName></packageName>
            <script>function onSysDataSendRequest(event, args)
  daagar.command = args
end


</script>
            <eventHandlerList>
                <string>sysDataSendRequest</string>
            </eventHandlerList>
        </Script>
    </ScriptPackage>
    <KeyPackage>
        <KeyGroup isActive="yes" isFolder="yes">
            <name>dmap</name>
            <packageName></packageName>
            <script></script>
            <command></command>
            <keyCode>-1</keyCode>
            <keyModifier>-1</keyModifier>
            <Key isActive="yes" isFolder="no">
                <name>North</name>
                <packageName></packageName>
                <script></script>
                <command>n</command>
                <keyCode>56</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>South</name>
                <packageName></packageName>
                <script></script>
                <command>s</command>
                <keyCode>50</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>East</name>
                <packageName></packageName>
                <script></script>
                <command>e</command>
                <keyCode>54</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>West</name>
                <packageName></packageName>
                <script></script>
                <command>w</command>
                <keyCode>52</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Northeast</name>
                <packageName></packageName>
                <script></script>
                <command>ne</command>
                <keyCode>57</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Northwest</name>
                <packageName></packageName>
                <script></script>
                <command>nw</command>
                <keyCode>55</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Southeast</name>
                <packageName></packageName>
                <script></script>
                <command>se</command>
                <keyCode>51</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Southwest</name>
                <packageName></packageName>
                <script></script>
                <command>sw</command>
                <keyCode>49</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Up</name>
                <packageName></packageName>
                <script></script>
                <command>u</command>
                <keyCode>45</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Down</name>
                <packageName></packageName>
                <script></script>
                <command>d</command>
                <keyCode>43</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
            <Key isActive="yes" isFolder="no">
                <name>Look</name>
                <packageName></packageName>
                <script></script>
                <command>l</command>
                <keyCode>53</keyCode>
                <keyModifier>536870912</keyModifier>
            </Key>
        </KeyGroup>
    </KeyPackage>
    <HelpPackage>
        <helpURL></helpURL>
    </HelpPackage>
</MudletPackage>
